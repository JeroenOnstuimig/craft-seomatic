{"version":3,"sources":["webpack:///./node_modules/events/events.js","webpack:///./node_modules/tokenfield/lib/tokenfield.js","webpack:///./node_modules/tokenfield/lib/ajax.js"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","module","exports","once","emitter","name","Promise","resolve","reject","eventListener","undefined","errorListener","removeListener","slice","arguments","err","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","handler","len","listeners","addListener","on","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","_tokenfields","reRegExpChar","reHasRegExpChar","RegExp","source","_factory","document","createElement","_templates","containerTokenfield","containerList","suggestItem","setItem","guid","Math","random","toString","includes","item","indexOf","findElement","input","nodeName","querySelector","build","html","all","replace","innerHTML","childNodes","keyToChar","e","keyIdentifier","fromCharCode","parseInt","substr","options","super","_defaults","_options","focusedItem","cache","timer","xhr","suggested","suggestedItems","setItems","delimiters","el","form","mode","addItemOnBlur","addItemsOnPaste","keepItemsOrder","items","newItems","multiple","maxItems","minLength","17","16","91","8","27","37","38","39","40","46","65","67","88","9","13","108","matchRegex","matchFlags","matchStart","matchEnd","copyProperty","copyDelimiter","remote","url","queryParam","delay","timestampParam","params","headers","placeholder","inputType","minChars","maxSuggest","maxSuggestWindow","filterSetItems","filterMatchCase","singleInput","singleInputValue","singleInputDelimiter","itemLabel","itemName","newItemName","itemValue","newItemValue","itemData","validateNewItem","id","_vars","assign","templates","_prepareData","remapData","_focused","_input","_form","_html","o","forEach","delimiter","tokenfield","node","parentNode","_render","container","suggest","suggestList","setAttribute","copyHelper","style","display","_renderSizer","parentElement","insertBefore","firstChild","_setEvents","_renderItems","_resizeInput","b","_getBounds","window","getComputedStyle","compensate","paddingLeft","paddingRight","styles","width","height","overflow","whiteSpace","maxWidth","top","left","fontSize","sizer","appendChild","empty","v","val","borderRightWidth","fullCompensate","borderLeftWidth","sb","getBoundingClientRect","ib","rw","r","reqData","limit","round","Date","getTime","callback","XMLHttpRequest","paramsArr","encodeURIComponent","paramsString","join","toLowerCase","open","header","setRequestHeader","onreadystatechange","send","ajax","readyState","status","response","JSON","parse","responseText","data","_filterData","_filterSetItems","showSuggestions","_abortXhr","map","regex","string","result","test","pattern","filter","abort","setKeys","onClick","_onClick","onMouseDown","_onMouseDown","onMouseOver","_onMouseOver","onFocus","_onFocus","onResize","_onResize","onReset","_onReset","onKeyDown","_onKeyDown","onFocusOut","_onFocusOut","addEventListener","classList","contains","querySelectorAll","remove","add","_selectItem","_refreshItemsSelection","removeEventListener","onPaste","_onPaste","trim","relatedTarget","canAddItem","_newItem","_refreshInput","_defocusItems","hideSuggestions","blur","preventDefault","clipboardData","getData","tokens","search","splitRegex","split","token","setTimeout","_deselectItems","keyCode","_keyAction","_refreshItems","clearTimeout","_keyInput","keyName","keyChar","selected","_getSelectedItems","_selectPrevItem","_selectNextItem","getFocusedItems","selectionStart","selectionEnd","_focusPrevItem","shiftKey","_focusNextItem","onInput","_addItem","focus","_refreshSuggestions","ctrlKey","metaKey","focused","_copy","_delete","focusedItems","copyString","select","execCommand","_removeItem","_focusItem","_fetchData","_getSuggestedItem","nodes","getPath","_getSelectedItemIndex","_getFocusedItemIndex","lastFocused","_defocusItem","setIds","scroll","maxHeight","listBounds","elBounds","bottom","scrollTop","every","k","last","prop","_filterItems","matchCase","splice","isNew","_getItem","clonedItem","ctrl","first","min","max","_getAvailableItem","itemEl","_renderItem","itemHtml","renderSetItemHtml","label","textContent","renderSetItemLabel","_buildEl","child","renderSuggestedItem","replaceChild","childElementCount","removeChild","renderSuggestedItemContent","renderSuggestions","isArray","addItems"],"mappings":"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","file":"js/vendors~seomatic-tokens.js","sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function eventListener() {\n      if (errorListener !== undefined) {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n    var errorListener;\n\n    // Adding an error listener is not optional because\n    // if an error is thrown on an event emitter we cannot\n    // guarantee that the actual event we are waiting will\n    // be fired. The result could be a silent way to create\n    // memory or file descriptor leaks, which is something\n    // we should avoid.\n    if (name !== 'error') {\n      errorListener = function errorListener(err) {\n        emitter.removeListener(name, eventListener);\n        reject(err);\n      };\n\n      emitter.once('error', errorListener);\n    }\n\n    emitter.once(name, eventListener);\n  });\n}\n","/**\n * Input field with tagging/token/chip capabilities written in raw JavaScript\n * tokenfield 1.4.3 <https://github.com/KaneCohen/tokenfield>\n * Copyright 2018 Kane Cohen <https://github.com/KaneCohen>\n * Available under BSD-3-Clause license\n */\nimport EventEmitter from 'events';\nimport ajax from './ajax.js';\n\nlet _tokenfields = {};\n\nconst reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\nconst reHasRegExpChar = RegExp(reRegExpChar.source);\n\nconst _factory = document.createElement('div');\n\nconst _templates = {\n  containerTokenfield: `<div class=\"tokenfield tokenfield-mode-tokens\">\n      <input class=\"tokenfield-copy-helper\"\n        style=\"display:none;position:fixed;top:-1000px;right:1000px;\"\n        tabindex=\"-1\"\n        type=\"text\"\n      />\n      <div class=\"tokenfield-set\">\n        <ul></ul>\n      </div>\n      <input class=\"tokenfield-input\" />\n      <div class=\"tokenfield-suggest\">\n        <ul class=\"tokenfield-suggest-list\"></ul>\n      </div>\n    </div>`,\n  containerList: `<div class=\"tokenfield tokenfield-mode-list\">\n      <input class=\"tokenfield-input\" />\n      <div class=\"tokenfield-suggest\">\n        <ul class=\"tokenfield-suggest-list\"></ul>\n      </div>\n      <div class=\"tokenfield-set\">\n        <ul></ul>\n      </div>\n    </div>`,\n  suggestItem: `<li class=\"tokenfield-suggest-item\"></li>`,\n  setItem: `<li class=\"tokenfield-set-item\">\n      <span class=\"item-label\"></span>\n      <a href=\"#\" class=\"item-remove\" tabindex=\"-1\">×</a>\n      <input class=\"item-input\" type=\"hidden\" />\n    </li>`\n};\n\nfunction guid() {\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16) +\n    (((1 + Math.random()) * 0x10000) | 0).toString(16);\n}\n\nfunction includes(arr, item) {\n  return arr.indexOf(item) >= 0;\n}\n\nfunction getPath(node) {\n  let nodes = [node];\n  while (node.parentNode) {\n    node = node.parentNode;\n    nodes.push(node);\n  }\n  return nodes;\n}\n\nfunction findElement(input) {\n  if (input.nodeName) {\n    return input;\n  } else if (typeof input === 'string') {\n    return document.querySelector(input);\n  }\n  return null;\n}\n\nfunction build(html, all) {\n  if (html.nodeName) return html;\n  html = html.replace(/(\\t|\\n$)/g, '');\n\n  _factory.innerHTML = '';\n  _factory.innerHTML = html;\n  if (all === true) {\n    return _factory.childNodes;\n  } else {\n    return _factory.childNodes[0];\n  }\n}\n\nfunction toString(value) {\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (value === null) {\n    return '';\n  }\n  let result = (value + '');\n  return (result === '0' && (1 / value) === -Infinity) ? '-0' : result;\n}\n\nfunction keyToChar(e) {\n  if (e.key || e.keyIdentifier) {\n    return e.key || String.fromCharCode(parseInt(e.keyIdentifier.substr(2), 16));\n  }\n  return null;\n}\n\nfunction escapeRegex(string) {\n  string = toString(string);\n  return (string && reHasRegExpChar.test(string)) ?\n    string.replace(reRegExpChar, '\\\\$&') :\n    string;\n}\n\nfunction makeDefaultsAndOptions() {\n  const _defaults = {\n    focusedItem: null,\n    cache: {},\n    timer: null,\n    xhr: null,\n    suggested: false,\n    suggestedItems: [],\n    setItems: [],\n    events: {},\n    delimiters: {}\n  };\n\n  const _options = {\n    el: null,\n    form: true,               // Listens to reset event on the specifiedform. If set to true listens to\n                              // immediate parent form. Also accepts selectors or elements.\n    mode: 'tokenfield',       // Display mode: tokenfield or list.\n    addItemOnBlur: false,     // Add token if input field loses focus.\n    addItemsOnPaste: false,   // Add tokens using `delimiters` option below to tokenize given string.\n    keepItemsOrder: true,     // Items and New Items values will be set in input with a specific position\n                              // in the list so that you can retreive correct position on the backend.\n    setItems: [],             // List of set items.\n    items: [],                // List of available items to work with.\n                              // Example: [{id: 143, value: 'Hello World'}, {id: 144, value: 'Foo Bar'}].\n    newItems: true,           // Allow input (on delimiter key) of new items.\n    multiple: true,           // Accept multiple items.\n    maxItems: 0,              // Set maximum allowed number of items.\n    minLength: 0,             // Minimum length of the string to be converted into token.\n    keys: {                   // Various action keys.\n      17:  'ctrl',\n      16:  'shift',\n      91:  'meta',\n      8:   'delete',          // Backspace\n      27:  'esc',\n      37:  'left',\n      38:  'up',\n      39:  'right',\n      40:  'down',\n      46:  'delete',\n      65:  'select',          // A\n      67:  'copy',            // C\n      88:  'cut',             // X\n      9:   'delimiter',       // Tab\n      13:  'delimiter',       // Enter\n      108: 'delimiter'        // Numpad Enter\n    },\n    matchRegex: '{value}',    // Match regex where {value} would be replaced by ecaped user input.\n    matchFlags: 'i',          // Flags used in regex matching.\n    matchStart: false,        // Set match regex to test from the beginning of the string.\n    matchEnd: false,          // Set match regex to test from the end of the string.\n    delimiters: [],           // Array of strings which act as delimiters during tokenization.\n    copyProperty: 'name',     // Property of the token used for copy event.\n    copyDelimiter: ', ',      // Delimiter used to populate clipboard with selected tokens.\n    remote: {\n      type: 'GET',            // Ajax request type.\n      url: null,              // Full server url.\n      queryParam: 'q',        // What param to use when asking server for data.\n      delay: 300,             // Dealy between last keydown event and ajax request for data.\n      timestampParam: 't',\n      params: {},\n      headers: {}\n    },\n    placeholder: null,        // Hardcoded placeholder text. If not set, will use placeholder from the element itself.\n    inputType: 'text',        // HTML attribute for the input element which lets mobile browsers use various input modes.\n                              // Accepts text, email, url, and others.\n    minChars: 2,              // Number of characters before we start to look for similar items.\n    maxSuggest: 10,           // Max items in the suggest box.\n    maxSuggestWindow: 10,     // Limit height of the suggest box after given number of items.\n    filterSetItems: true,     // Filters already set items from the suggestions list.\n    filterMatchCase: false,   // Sets case-sensitivity for checking whether new item is already set in the list.\n\n    singleInput: false,       // Pushes all token values into a single. Accepts: true, 'selector', or an element.\n                              // When set to true - would use tokenfield target element as an input to fill.\n    singleInputValue: 'id',   // Which property of the item to use when using fillInput.\n    singleInputDelimiter: ', ',\n\n    itemLabel: 'name',        // Property to use in order to render item label.\n    itemName: 'items',        // If set, for each tag/token there will be added\n                              // input field with array property name:\n                              // name=\"items[]\".\n\n    newItemName: 'items_new', // Suffix that will be added to the new tag in\n                              // case it was not available from the server:\n                              // name=\"items_new[]\".\n\n    itemValue: 'id',         // Value that will be taken out of the results and inserted into itemAttr.\n    newItemValue: 'name',    // Value that will be taken out of the results and inserted into itemAttr.\n    itemData: 'name',        // Which property to search for.\n    validateNewItem: null    // Run a function to test if new item is valid and can be added.\n  };\n  return {_defaults, _options};\n}\n\nclass Tokenfield extends EventEmitter {\n  constructor(options = {}) {\n    super();\n\n    let { _defaults, _options } = makeDefaultsAndOptions();\n\n    this.id = guid();\n    this.key = `key_${this.id}`;\n    this._vars = Object.assign({}, _defaults);\n    this._options = Object.assign({}, _options, options);\n    this._options.keys = Object.assign({}, _options.keys, options.keys);\n    this._options.remote = Object.assign({}, _options.remote, options.remote);\n    this._templates = Object.assign({}, _templates, options.templates);\n    this._vars.setItems = this._prepareData(this.remapData(this._options.setItems || []));\n    this._focused = false;\n    this._input = null;\n    this._form = false;\n    this._html = {};\n\n    let o = this._options;\n\n    // Make a hash map to simplify filtering later.\n    o.delimiters.forEach((delimiter) => {\n      this._vars.delimiters[delimiter] = true;\n    });\n\n    let el = findElement(o.el);\n    if (el) {\n      this.el = el;\n    } else {\n      throw new Error(`Selector: DOM Element ${o.el} not found.`);\n    }\n\n    if (o.singleInput) {\n      let el = findElement(o.singleInput);\n      if (el) {\n        this._input = el;\n      } else {\n        this._input = this.el;\n      }\n    }\n\n    this.el.tokenfield = this;\n\n    if (o.placeholder === null) {\n      o.placeholder = o.el.placeholder || '';\n    }\n\n    if (o.form) {\n      let form = false;\n      if (o.form.nodeName) {\n        form = o.form;\n      } else if (o.form === true) {\n        let node = this.el;\n        while (node.parentNode) {\n          if (node.nodeName === 'FORM') {\n            form = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n      } else if (typeof form == 'string') {\n        form = document.querySelector(form);\n        if (! form) {\n          throw new Error(`Selector: DOM Element ${o.form} not found.`);\n        }\n      }\n      this._form = form;\n    } else {\n      throw new Error(`Cannot create tokenfield without DOM Element.`);\n    }\n\n    _tokenfields[this.id] = this;\n\n    this._render();\n  }\n\n  _render() {\n    let o = this._options;\n    let html = this._html;\n\n    if (o.mode === 'tokenfield') {\n      html.container = build(this._templates.containerTokenfield);\n    } else {\n      html.container = build(this._templates.containerList);\n    }\n    html.suggest = html.container.querySelector('.tokenfield-suggest');\n    html.suggestList = html.container.querySelector('.tokenfield-suggest-list');\n    html.items = html.container.querySelector('.tokenfield-set > ul');\n    html.input = html.container.querySelector('.tokenfield-input');\n    html.input.setAttribute('type', o.inputType);\n    if (o.mode === 'tokenfield') {\n      html.input.placeholder = this._vars.setItems.length ? '' : o.placeholder;\n    } else {\n      html.input.placeholder = o.placeholder;\n    }\n    html.copyHelper = html.container.querySelector('.tokenfield-copy-helper');\n\n    o.el.style.display = 'none';\n    html.suggest.style.display = 'none';\n    this._renderSizer();\n\n    // Set tokenfield in DOM.\n    html.container.tokenfield = this;\n    o.el.parentElement.insertBefore(html.container, o.el);\n    html.container.insertBefore(o.el, html.container.firstChild);\n\n    this._setEvents();\n    this._renderItems();\n    if (o.mode === 'tokenfield') {\n      this._resizeInput();\n    }\n\n    return this;\n  }\n\n  _renderSizer() {\n    let html = this._html;\n    let b = this._getBounds();\n    let style = window.getComputedStyle(html.container);\n    let compensate = parseInt(style.paddingLeft, 10) +\n      parseInt(style.paddingRight, 10);\n\n    let styles = {\n      width: 'auto',\n      height: 'auto',\n      overflow: 'hidden',\n      whiteSpace: 'pre',\n      maxWidth: b.width - compensate + 'px',\n      position: 'fixed',\n      top: -10000 + 'px',\n      left: 10000 + 'px',\n      fontSize: style.fontSize,\n      paddingLeft: style.paddingLeft,\n      paddingRight: style.paddingRight\n    };\n\n    html.sizer = document.createElement('div');\n    html.sizer.id = 'tokenfield-sizer-' + this.id;\n    for (let key in styles) {\n      html.sizer.style[key] = styles[key];\n    }\n    html.container.appendChild(html.sizer);\n  }\n\n  _refreshInput(empty = true) {\n    let v = this._vars;\n    let html = this._html;\n\n    if (empty) html.input.value = '';\n\n    if (this._options.mode === 'tokenfield') {\n      this._resizeInput();\n      let placeholder =  v.setItems.length ? '' : this._options.placeholder;\n      html.input.setAttribute('placeholder', placeholder);\n    } else if (this._options.mode === 'list') {\n      html.input.setAttribute('placeholder', this._options.placeholder);\n    }\n    return this;\n  }\n\n  _resizeInput(val = '') {\n    let html = this._html;\n    let b = this._getBounds();\n    let style = window.getComputedStyle(html.container);\n    let compensate = parseInt(style.paddingRight, 10) +\n      parseInt(style.borderRightWidth, 10);\n\n    let fullCompensate = compensate +\n      parseInt(style.paddingLeft, 10) +\n      parseInt(style.borderLeftWidth, 10);\n\n    html.sizer.innerHTML = val;\n    html.sizer.style.maxWidth = b.width - compensate + 'px';\n\n    if (b.width === 0) {\n      html.input.style.width = '100%';\n      return;\n    } else {\n      html.input.style.width = '20px';\n    }\n\n    let sb = html.sizer.getBoundingClientRect();\n    let ib = html.input.getBoundingClientRect();\n    let rw = b.width - (ib.left - b.left) - compensate;\n\n    if (sb.width > rw) {\n      html.input.style.width = (b.width - fullCompensate - 1) + 'px';\n    } else {\n      html.input.style.width = (rw - 1) + 'px';\n    }\n  }\n\n  _fetchData(val) {\n    let v = this._vars;\n    let o = this._options;\n    let r = o.remote;\n    let reqData = Object.assign({}, o.params);\n\n    for (let key in r.params) {\n      reqData[key] = r.params[key];\n    }\n\n    if (r.limit) {\n      reqData[r.limit] = o.remote.limit;\n    }\n\n    reqData[r.queryParam] = val;\n    reqData[r.timestampParam] = Math.round((new Date()).getTime() / 1000);\n\n    v.xhr = ajax(reqData, o.remote, () => {\n      if (v.xhr && v.xhr.readyState == 4) {\n        if (v.xhr.status == 200) {\n          let response = JSON.parse(v.xhr.responseText);\n          v.cache[val] = response;\n          let data = this._prepareData(this.remapData(response));\n          let items = this._filterData(val, data);\n          v.suggestedItems = o.filterSetItems ? this._filterSetItems(items) : items;\n          this.showSuggestions();\n        } else if (v.xhr.status > 0) {\n          throw new Error('Error while loading remote data.');\n        }\n        this._abortXhr();\n      }\n    });\n  }\n\n  // Overwriteable method where you can change given data to appropriate format.\n  remapData(data) {\n    return data;\n  }\n\n  _prepareData(data) {\n    return data.map(item => {\n      return Object.assign({}, item, {\n        [this.key]: guid()\n      });\n    });\n  }\n\n  _filterData(val, data) {\n    let o = this._options;\n    let regex = o.matchRegex.replace('{value}', escapeRegex(val));\n    if (o.matchStart) {\n      regex = '^' + regex;\n    } else if (o.matchEnd) {\n      regex = regex + '$';\n    }\n    let pattern = new RegExp(regex, o.matchFlags);\n    return data.filter(item => pattern.test(item[o.itemData]));\n  }\n\n  _abortXhr() {\n    let v = this._vars;\n    if (v.xhr !== null) {\n      v.xhr.abort();\n      v.xhr = null;\n    }\n  }\n\n  _filterSetItems(items) {\n    const key = this._options.itemValue;\n    let v = this._vars;\n    if (! v.setItems.length) return items;\n\n    let setKeys = v.setItems.map(item => item[key]);\n\n    return items.filter(item => {\n      if (setKeys.indexOf(item[key]) === -1) {\n        return true;\n      }\n      return false;\n    });\n  }\n\n  _setEvents() {\n    let v = this._vars;\n    let html = this._html;\n    v.events.onClick = this._onClick.bind(this);\n    v.events.onMouseDown = this._onMouseDown.bind(this);\n    v.events.onMouseOver = this._onMouseOver.bind(this);\n    v.events.onFocus = this._onFocus.bind(this);\n    v.events.onResize = this._onResize.bind(this);\n    v.events.onReset = this._onReset.bind(this);\n    v.events.onKeyDown = this._onKeyDown.bind(this);\n    v.events.onFocusOut = this._onFocusOut.bind(this);\n\n    html.container.addEventListener('click', v.events.onClick);\n\n    // Attach document event only once.\n    if (Object.keys(_tokenfields).length === 1) {\n      document.addEventListener('mousedown', v.events.onMouseDown);\n      window.addEventListener('resize', v.events.onResize);\n    }\n\n    if (this._form && this._form.nodeName) {\n      this._form.addEventListener('reset', v.events.onReset);\n    }\n\n    html.suggestList.addEventListener('mouseover', v.events.onMouseOver);\n    html.input.addEventListener('focus', v.events.onFocus);\n  }\n\n  _onMouseOver(e) {\n    let target = e.target;\n    if (target.classList.contains('tokenfield-suggest-item')) {\n      let selected = [].slice.call(this._html.suggestList.querySelectorAll('.selected'));\n      selected.forEach(item => {\n        if (item !== target) item.classList.remove('selected');\n      });\n      target.classList.add('selected');\n      this._selectItem(target.key, false);\n      this._refreshItemsSelection();\n    }\n  }\n\n  _onReset() {\n    this.setItems(this._options.setItems);\n  }\n\n  _onFocus() {\n    let v = this._vars;\n    let html = this._html;\n    let o = this._options;\n\n    html.input.removeEventListener('keydown', v.events.onKeyDown);\n    html.input.addEventListener('keydown', v.events.onKeyDown);\n    html.input.addEventListener('focusout', v.events.onFocusOut);\n\n    if (o.addItemsOnPaste) {\n      v.events.onPaste = this._onPaste.bind(this);\n      html.input.addEventListener('paste', v.events.onPaste);\n    }\n\n    this._focused = true;\n    this._html.container.classList.add('focused');\n    this._resizeInput();\n\n    if (html.input.value.trim().length >= o.minChars) {\n      this.showSuggestions();\n    }\n  }\n\n  _onFocusOut(e) {\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n    html.input.removeEventListener('keydown', v.events.onKeyDown);\n    html.input.removeEventListener('focusout', v.events.onFocusOut);\n\n    if (typeof v.events.onPaste !== 'undefined') {\n      html.input.removeEventListener('paste', v.events.onPaste);\n    }\n\n    if (e.relatedTarget && e.relatedTarget === html.copyHelper) {\n      return;\n    }\n\n    let canAddItem = ((o.multiple && ! o.maxItems) ||\n      (! o.multiple && ! v.setItems.length) ||\n      (o.multiple && o.maxItems && v.setItems.length < o.maxItems));\n\n    if (this._focused &&\n      o.addItemOnBlur &&\n      canAddItem &&\n      this._newItem(html.input.value)\n    ) {\n      this._renderItems()._refreshInput();\n    } else {\n      this._defocusItems()._renderItems();\n    }\n\n    this._focused = false;\n    this._html.container.classList.remove('focused');\n  }\n\n  _onMouseDown(e) {\n    let tokenfield = null;\n    for (let key in _tokenfields) {\n      if (_tokenfields[key]._html.container.contains(e.target)) {\n        tokenfield = _tokenfields[key];\n        break;\n      }\n    }\n\n    if (tokenfield) {\n      for (let key in _tokenfields) {\n        if (key !== tokenfield.id) {\n          _tokenfields[key].hideSuggestions();\n          _tokenfields[key].blur();\n        }\n      }\n\n      // Prevent input blur.\n      if (e.target !== tokenfield._html.input) {\n        e.preventDefault();\n      }\n    } else {\n      for (let key in _tokenfields) {\n        _tokenfields[key].hideSuggestions();\n        _tokenfields[key].blur();\n      }\n    }\n  }\n\n  _onResize() {\n    for (let key in _tokenfields) {\n      _tokenfields[key]._resizeInput(_tokenfields[key]._html.input.value);\n    }\n  }\n\n  _onPaste(e) {\n    let v = this._vars;\n    let o = this._options;\n    let val = e.clipboardData.getData('text');\n    let tokens = [val];\n\n    // Break input using delimiters option.\n    if (o.delimiters.length) {\n      let search = o.delimiters.join('|');\n      let splitRegex = new RegExp(`(${search})`, 'ig');\n      tokens = val.split(splitRegex);\n    }\n\n    let items = tokens\n      .map((token) => token.trim())\n      .filter((token) => {\n        return token.length > 0 &&\n          token.length >= o.minLength &&\n            typeof v.delimiters[token] === 'undefined';\n      })\n      .map((token) => {\n        return this._newItem(token);\n      });\n\n    if (items.length) {\n      setTimeout(() => {\n        this._renderItems()\n          ._refreshInput()\n          ._deselectItems()\n          .hideSuggestions();\n      }, 1);\n\n      e.preventDefault();\n    }\n  }\n\n  _onKeyDown(e) {\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n\n    if (o.maxItems && v.setItems.length >= o.maxItems) {\n      e.preventDefault();\n    }\n\n    if (o.mode === 'tokenfield') {\n      setTimeout(() => {\n        this._resizeInput(html.input.value);\n      }, 1);\n    }\n\n    let key = keyToChar(e);\n    if (typeof o.keys[e.keyCode] !== 'undefined' || includes(o.delimiters, key)) {\n      if (this._keyAction(e)) return true;\n    } else {\n      this._defocusItems()._refreshItems();\n    }\n\n    clearTimeout(v.timer);\n    this._abortXhr();\n\n    if (! o.maxItems || v.setItems.length < o.maxItems) {\n      setTimeout(() => {\n        this._keyInput(e);\n      }, 1);\n    }\n  }\n\n  _keyAction(e) {\n    const key = this.key;\n    let item = null;\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n    let keyName = o.keys[e.keyCode];\n    let val = html.input.value.trim();\n    let keyChar = keyToChar(e);\n\n    if (includes(o.delimiters, keyChar) && typeof keyName === 'undefined') {\n      keyName = 'delimiter';\n    }\n\n    let selected = this._getSelectedItems();\n    if (selected.length) {\n      item = selected[0];\n    }\n\n    switch (keyName) {\n      case 'esc':\n        this._deselectItems()._defocusItems()._renderItems().hideSuggestions();\n        break;\n      case 'up':\n        if (this._vars.suggested) {\n          this._selectPrevItem()._refreshItemsSelection();\n          e.preventDefault();\n        }\n        this._defocusItems()._renderItems();\n        break;\n      case 'down':\n        if (this._vars.suggested) {\n          this._selectNextItem()._refreshItemsSelection();\n          e.preventDefault();\n        }\n        this._defocusItems()._renderItems();\n        break;\n      case 'left':\n        if (this.getFocusedItems().length ||\n          (! html.input.selectionStart && ! html.input.selectionEnd)\n        ) {\n          this._focusPrevItem(e.shiftKey);\n          e.preventDefault();\n        }\n        break;\n      case 'right':\n        if (this.getFocusedItems().length ||\n          html.input.selectionStart === val.length\n        ) {\n          this._focusNextItem(e.shiftKey);\n          e.preventDefault();\n        }\n        break;\n      case 'delimiter':\n        this._abortXhr();\n        this._defocusItems();\n\n        if (! o.multiple && v.setItems.length >= 1) {\n          return false;\n        }\n\n        val = this.onInput(val, e);\n        if (item) {\n          this._addItem(item);\n        } else if (val.length) {\n          item = this._newItem(val);\n        }\n\n        if (item) {\n          this._renderItems()\n            .focus()\n            ._refreshInput()\n            ._refreshSuggestions()\n            ._deselectItems();\n        }\n        e.preventDefault();\n        break;\n      case 'select':\n        if (! val.length && (e.ctrlKey || e.metaKey)) {\n          this._vars.setItems.forEach((item) => {\n            item.focused = true;\n          });\n          this._refreshItems();\n        } else {\n          return false;\n        }\n        break;\n      case 'cut': {\n        let focusedItems = this.getFocusedItems();\n        if (focusedItems.length && (e.ctrlKey || e.metaKey)) {\n          this._copy()._delete(e);\n        } else {\n          return false;\n        }\n        break;\n      }\n      case 'copy': {\n        let focusedItems = this.getFocusedItems();\n        if (focusedItems.length && (e.ctrlKey || e.metaKey)) {\n          this._copy();\n        } else {\n          return false;\n        }\n        break;\n      }\n      case 'delete': {\n        this._abortXhr();\n        let focusedItems = this.getFocusedItems();\n        if ((! html.input.selectionEnd && e.keyCode === 8) ||\n          (html.input.selectionStart === val.length && e.keyCode === 46) ||\n          focusedItems.length\n        ) {\n          this._delete(e);\n        } else {\n          v.timer = setTimeout(() => {\n            this._keyInput(e);\n          }, o.delay);\n        }\n        break;\n      }\n      default:\n        break;\n    }\n\n    return true;\n  }\n\n  _copy() {\n    let o = this._options;\n    let html = this._html;\n    let copyString = this.getFocusedItems()\n      .map(item => item[o.copyProperty])\n      .join(o.copyDelimiter);\n\n    html.copyHelper.style.display = 'block';\n    html.copyHelper.value = copyString;\n    html.copyHelper.focus();\n    html.copyHelper.select();\n    document.execCommand('copy');\n    html.copyHelper.style.display = 'none';\n    html.copyHelper.value = '';\n    html.input.focus();\n\n    return this;\n  }\n\n  _delete(e) {\n    let v = this._vars;\n    let o = this._options;\n    const key = this.key;\n    let html = this._html;\n    let focusedItems = this.getFocusedItems();\n\n    if (o.mode === 'tokenfield' && v.setItems.length) {\n      if (focusedItems.length) {\n        focusedItems.forEach((item) => {\n          this._removeItem(item[key]);\n        });\n        this._refreshSuggestions()._keyInput(e);\n      } else if (! html.input.selectionStart) {\n        this._focusItem(v.setItems[v.setItems.length - 1][key]);\n      }\n    } else if (focusedItems.length) {\n      focusedItems.forEach((item) => {\n        this._removeItem(item[key]);\n      });\n      this._refreshSuggestions()._keyInput(e);\n    }\n    this._renderItems()._refreshInput(false);\n\n    return this;\n  }\n\n  _keyInput(e) {\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n\n    this._defocusItems()._refreshItems();\n\n    const val = this.onInput(html.input.value.trim(), e);\n\n    if (e.type === 'keydown') {\n      this.emit('input', this, val, e);\n    }\n\n    if (val.length < o.minChars) {\n      this.hideSuggestions();\n      return false;\n    }\n\n    if (! o.multiple && v.setItems.length >= 1) {\n      return false;\n    }\n\n    // Check if we have cache with this val.\n    if (typeof v.cache[val] === 'undefined') {\n      // Get new data.\n      if (o.remote.url) {\n        v.timer = setTimeout(() => {\n          this._fetchData(val);\n        }, o.delay);\n      } else if (! o.remote.url && o.items.length) {\n        let data = this._prepareData(o.items);\n        let items = this._filterData(val, data);\n        v.suggestedItems = o.filterSetItems ? this._filterSetItems(items) : items;\n        this.showSuggestions();\n      }\n    } else {\n      // Work with cached data.\n      let data = this._prepareData(this.remapData(v.cache[val]));\n      let items = this._filterData(val, data);\n      v.suggestedItems = o.filterSetItems ? this._filterSetItems(items) : items;\n      this.showSuggestions();\n    }\n\n    return this;\n  }\n\n  _onClick(e) {\n    let target = e.target;\n\n    if (target.classList.contains('item-remove')) {\n      e.preventDefault();\n\n      this._removeItem(target.key)\n        ._defocusItems()\n        ._renderItems()\n        ._refreshInput(false)\n        ._keyInput(e);\n    } else if (target.classList.contains('tokenfield-suggest-item')) {\n      let item = this._getSuggestedItem(target.key);\n      this._addItem(item)\n        ._renderItems()\n        ._refreshInput()\n        ._refreshSuggestions();\n    } else {\n      let setItem = getPath(target).filter((node) => {\n        return node.classList && node.classList.contains('tokenfield-set-item');\n      })[0];\n\n      if (setItem) {\n        this._focusItem(setItem.key, e.shiftKey, e.ctrlKey || e.metaKey, true);\n        this._refreshItems();\n      } else {\n        this._keyInput(e);\n      }\n    }\n\n    this.focus();\n  }\n\n  _selectPrevItem() {\n    const key = this.key;\n    const o = this._options;\n    let items = this._vars.suggestedItems;\n    let index = this._getSelectedItemIndex();\n\n    if (! items.length) {\n      return this;\n    }\n\n    if (index !== null) {\n      if (index === 0) {\n        if (o.newItems) {\n          this._deselectItems();\n        } else {\n          this._selectItem(items[items.length - 1][key]);\n        }\n      } else {\n        this._selectItem(items[index - 1][key]);\n      }\n    } else {\n      this._selectItem(items[items.length - 1][key]);\n    }\n\n    return this;\n  }\n\n  _selectNextItem() {\n    const key = this.key;\n    const o = this._options;\n    let items = this._vars.suggestedItems;\n    let index = this._getSelectedItemIndex();\n\n    if (! items.length) {\n      return this;\n    }\n\n    if (index !== null) {\n      if (index === items.length - 1) {\n        if (o.newItems) {\n          this._deselectItems();\n        } else {\n          this._selectItem(items[0][key]);\n        }\n      } else {\n        this._selectItem(items[index + 1][key]);\n      }\n    } else {\n      this._selectItem(items[0][key]);\n    }\n\n    return this;\n  }\n\n  _focusPrevItem(multiple = false) {\n    const key = this.key;\n    let items = this._vars.setItems;\n    let index = this._getFocusedItemIndex();\n\n    if (! items.length) {\n      return this;\n    }\n\n    if (index !== null) {\n      if (index === 0 && ! multiple) {\n        this._defocusItems();\n      } else if (index === 0 && multiple) {\n        let lastFocused = this._getFocusedItemIndex(true);\n        this._defocusItem(items[lastFocused][key]);\n      } else {\n        this._focusItem(items[index - 1][key], multiple, false, true);\n      }\n    } else {\n      this._focusItem(items[items.length - 1][key], false, false, true);\n    }\n    this._refreshItems();\n\n    return this;\n  }\n\n  _focusNextItem(multiple = false) {\n    const key = this.key;\n    let items = this._vars.setItems;\n    let index = this._getFocusedItemIndex(true);\n\n    if (! items.length) {\n      return this;\n    }\n\n    if (index !== null) {\n      if (index === items.length - 1 && ! multiple) {\n        this._defocusItems();\n      } else if (index === items.length - 1 && multiple) {\n        this._focusItem(items[0][key], multiple);\n      } else {\n        this._focusItem(items[index + 1][key], multiple);\n      }\n    } else {\n      this._focusItem(items[0][key], false);\n    }\n    this._refreshItems();\n\n    return this;\n  }\n\n  _getSelectedItems() {\n    const key = this.key;\n    let setIds = this._vars.setItems.map(item => item[key]);\n    return this._vars.suggestedItems.filter(v => {\n      return v.selected && setIds.indexOf(v[key]) < 0;\n    });\n  }\n\n  _selectItem(key, scroll = false) {\n    this._vars.suggestedItems.forEach(v => {\n      v.selected = v[this.key] === key;\n      if (v.selected && scroll) {\n        let height = parseInt(this._html.suggest.style.maxHeight, 10);\n        if (height) {\n          let listBounds = this._html.suggestList.getBoundingClientRect();\n          let elBounds = v.el.getBoundingClientRect();\n          let top = elBounds.top - listBounds.top;\n          let bottom = top + elBounds.height;\n\n          if (bottom >= height + this._html.suggest.scrollTop) {\n            this._html.suggest.scrollTop = bottom - height;\n          } else if (top < this._html.suggest.scrollTop) {\n            this._html.suggest.scrollTop = top;\n          }\n        }\n      }\n    });\n  }\n\n  _deselectItem(key) {\n    this._vars.suggestedItems.every(v => {\n      if (v[this.key] === key) {\n        v.selected = false;\n        return false;\n      }\n      return true;\n    });\n    return this;\n  }\n\n  _deselectItems() {\n    this._vars.suggestedItems.forEach(v => {\n      v.selected = false;\n    });\n    return this;\n  }\n\n  _refreshItemsSelection() {\n    this._vars.suggestedItems.forEach(v => {\n      if (v.selected && v.el) {\n        v.el.classList.add('selected');\n      } else if (v.el) {\n        v.el.classList.remove('selected');\n      }\n    });\n  }\n\n  _getSelectedItemIndex() {\n    let index = null;\n    this._vars.suggestedItems.every((v, k) => {\n      if (v.selected) {\n        index = k;\n        return false;\n      }\n      return true;\n    });\n    return index;\n  }\n\n  _getFocusedItemIndex(last = false) {\n    let index = null;\n    this._vars.setItems.every((v, k) => {\n      if (v.focused) {\n        index = k;\n        if (! last) {\n          return false;\n        }\n      }\n      return true;\n    });\n    return index;\n  }\n\n  _getItem(val, prop = null) {\n    if (prop === null) prop = this.key;\n    let items = this._filterItems(this._vars.setItems, val, prop);\n    return items.length ? items[0] : null;\n  }\n\n  _getSuggestedItem(val, prop = null) {\n    if (prop === null) prop = this.key;\n    let items = this._filterItems(this._vars.suggestedItems, val, prop);\n    return items.length ? items[0] : null;\n  }\n\n  _getAvailableItem(val, prop = null) {\n    if (prop === null) prop = this.key;\n    let items = this._filterItems(this._options.items, val, prop);\n    return items.length ? items[0] : null;\n  }\n\n  _filterItems(items, val, prop) {\n    const matchCase = this._options.filterMatchCase;\n    return items.filter(v => {\n      if (typeof v[prop] === 'string' && typeof val === 'string') {\n        if (matchCase) return v[prop] === val;\n        return v[prop].toLowerCase() == val.toLowerCase();\n      }\n      return v[prop] == val;\n    });\n  }\n\n  _removeItem(key) {\n    this._vars.setItems.every((item, k) => {\n      if (item[this.key] === key) {\n        this.emit('removeToken', this, item);\n        this._vars.setItems.splice(k, 1);\n        this.emit('removedToken', this, item);\n        this.emit('change', this);\n        return false;\n      }\n      return true;\n    });\n    return this;\n  }\n\n  _addItem(item) {\n    item.focused = false;\n    let o = this._options;\n    // Check if item already exists in a given list.\n    if ((item.isNew && ! this._getItem(item[o.itemData], o.itemData)) ||\n      ! this._getItem(item[o.itemValue], o.itemValue)\n    ) {\n      this.emit('addToken', this, item);\n      if (! this._options.maxItems ||\n        (this._options.maxItems && this._vars.setItems.length < this._options.maxItems)\n      ) {\n        item.selected = false;\n        let clonedItem = Object.assign({}, item);\n        this._vars.setItems.push(clonedItem);\n        this.emit('addedToken', this, clonedItem);\n        this.emit('change', this);\n      }\n    }\n    return this;\n  }\n\n  getFocusedItem() {\n    let items = this._vars.setItems.filter(item => {\n      return item.focused;\n    })[0];\n    if (items.length) return items[0];\n    return null;\n  }\n\n  getFocusedItems() {\n    return this._vars.setItems.filter(item => {\n      return item.focused;\n    });\n  }\n\n  _focusItem(key, shift = false, ctrl = false, add = false) {\n    if (shift) {\n      let first = null;\n      let last = null;\n      let target = null;\n      let length = this._vars.setItems.length;\n      this._vars.setItems.forEach((item, k) => {\n        if (item[this.key] === key) {\n          target = k;\n        }\n        if (first === null && item.focused) {\n          first = k;\n        }\n        if (item.focused) {\n          last = k;\n        }\n      });\n\n      if ((target === 0 || target === length - 1) && first === null && last === null) {\n        return;\n      } else if (first === null && last === null) {\n        this._vars.setItems[target].focused = true;\n      } else if (target === 0 && last === length - 1 && ! add) {\n        this._vars.setItems[first].focused = false;\n      } else {\n        first = Math.min(target, first);\n        last = Math.max(target, last);\n        this._vars.setItems.forEach((item, k) => {\n          item.focused = target === k || (k >= first && k <= last);\n        });\n      }\n    } else {\n      this._vars.setItems.forEach(item => {\n        if (ctrl) {\n          item.focused = item[this.key] === key ? ! item.focused : item.focused;\n        } else {\n          item.focused = item[this.key] === key;\n        }\n      });\n    }\n    return this;\n  }\n\n  _defocusItem(key) {\n    return this._vars.setItems.filter(item => {\n      if (item[this.key] === key) {\n        item.focused = false;\n      }\n    });\n  }\n\n  _defocusItems() {\n    this._vars.setItems.forEach(item => {\n      item.focused = false;\n    });\n    return this;\n  }\n\n  _newItem(value) {\n    let o = this._options;\n\n    if (typeof value === 'string' &&\n      (!value.length || value.length < o.minLength)) return null;\n\n    let item = this._getItem(value, o.itemData) ||\n               this._getSuggestedItem(value, o.itemData) ||\n               this._getAvailableItem(value, o.itemData);\n\n    if (! item && o.newItems) {\n      // If validation is set and returns false - item should not be added.\n      if (typeof o.validateNewItem === 'function' && !o.validateNewItem(value)) {\n        return null;\n      }\n\n      item = {\n        isNew: true,\n        [this.key]: guid(),\n        [o.itemData]: value\n      };\n      this.emit('newToken', this, item);\n    }\n\n    if (item) {\n      this._addItem(item);\n      return item;\n    }\n\n    return null;\n  }\n\n  // Wrapper for build function in case some of the functions are overwritten.\n  _buildEl(html) {\n    return build(html);\n  }\n\n  _getBounds() {\n    return this._html.container.getBoundingClientRect();\n  }\n\n  _renderItems() {\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n\n    html.items.innerHTML = '';\n    v.setItems.forEach((item, k) => {\n      let itemEl = this._renderItem(item, k);\n      html.items.appendChild(itemEl);\n      item.el = itemEl;\n      if (item.focused) {\n        item.el.classList.add('focused');\n      } else {\n        item.el.classList.remove('focused');\n      }\n    });\n\n    if (v.setItems.length > 1 && o.mode === 'tokenfield') {\n      html.input.setAttribute('placeholder', '');\n    } else if (o.mode === 'list') {\n      html.input.setAttribute('placeholder', o.placeholder);\n    }\n\n    if (this._input) {\n      this._input.value = v.setItems.map(item => item[o.singleInputValue])\n        .join(o.singleInputDelimiter);\n    }\n\n    return this;\n  }\n\n  _refreshItems() {\n    let v = this._vars;\n\n    v.setItems.forEach(item => {\n      if (item.el) {\n        if (item.focused) {\n          item.el.classList.add('focused');\n        } else {\n          item.el.classList.remove('focused');\n        }\n      }\n    });\n  }\n\n  _renderItem(item, k) {\n    let o = this._options;\n\n    let itemHtml = this.renderSetItemHtml(item);\n    let label = itemHtml.querySelector('.item-label');\n    let input = itemHtml.querySelector('.item-input');\n    let remove = itemHtml.querySelector('.item-remove');\n    let position = o.keepItemsOrder ? `[${k}]` : '[]';\n\n    itemHtml.key = item[this.key];\n    remove.key = item[this.key];\n    input.setAttribute('name', (item.isNew ? o.newItemName : o.itemName) + position);\n\n    input.value = item[(item.isNew ? o.newItemValue : o.itemValue)] || null;\n    label.textContent = this.renderSetItemLabel(item);\n    if (item.focused) {\n      itemHtml.classList.add('focused');\n    }\n\n    return itemHtml;\n  }\n\n  onInput(value, e) {\n    return value;\n  }\n\n  renderSetItemHtml() {\n    return this._buildEl(this._templates.setItem);\n  }\n\n  renderSetItemLabel(item) {\n    return item[this._options.itemLabel];\n  }\n\n  renderSuggestions(items) {\n    let v = this._vars;\n    let o = this._options;\n    let html = this._html;\n    let index = this._getSelectedItemIndex();\n\n    if (! items.length) {\n      return this;\n    }\n\n    if (o.maxSuggestWindow === 0) {\n      html.suggest.style.maxHeight = null;\n    }\n\n    if (! v.suggestedItems.length) {\n      return this;\n    }\n\n    if (! o.newItems && index === null) {\n      items[0].selected = true;\n    }\n\n    let maxHeight = 0;\n\n    items.every((item, k) => {\n      if (k >= o.maxSuggest) return false;\n      let child = html.suggestList.childNodes[k];\n      let el = item.el = this.renderSuggestedItem(item);\n\n      if (child) {\n        if (child.itemValue === item[o.itemValue]) {\n          child.key = item[this.key];\n          item.el = child;\n        } else {\n          html.suggestList.replaceChild(el, child);\n        }\n      } else if (!child) {\n        html.suggestList.appendChild(el);\n      }\n\n      if (o.maxSuggestWindow > 0 && k < o.maxSuggestWindow) {\n        maxHeight += html.suggestList.childNodes[k].getBoundingClientRect().height;\n      }\n\n      if (o.maxSuggestWindow > 0 && k === o.maxSuggestWindow) {\n        html.suggest.style.maxHeight = maxHeight + 'px';\n      }\n\n      return true;\n    });\n\n    let overflow = html.suggestList.childElementCount - items.length;\n    if (overflow > 0) {\n      for (let i = overflow- 1; i >= 0; i--) {\n        html.suggestList.removeChild(html.suggestList.childNodes[items.length + i]);\n      }\n    }\n\n    return this;\n  }\n\n  renderSuggestedItem(item) {\n    let o = this._options;\n    let el = this._buildEl(this._templates.suggestItem);\n    el.key = item[this.key];\n    el.itemValue = item[o.itemValue];\n    el.innerHTML = this.renderSuggestedItemContent(item);\n    el.setAttribute('title', item[o.itemData]);\n    if (item.selected) {\n      el.classList.add('selected');\n    }\n    if (! o.filterSetItems) {\n      let setItem = this._getItem(item[o.itemValue], o.itemValue) ||\n        this._getItem(item[o.itemData], o.itemData);\n\n      if (setItem) {\n        el.classList.add('set');\n      }\n    }\n    return el;\n  }\n\n  renderSuggestedItemContent(item) {\n    return item[this._options.itemData];\n  }\n\n  _refreshSuggestions() {\n    let v = this._vars;\n    let o = this._options;\n\n    if (this._html.input.value.length < o.minChars) {\n      this.hideSuggestions();\n      return this;\n    }\n\n    let data = this._prepareData(o.items);\n    let items = this._filterData(this._html.input.value, data);\n    v.suggestedItems = o.filterSetItems ? this._filterSetItems(items) : items;\n\n    if (v.suggestedItems.length) {\n      if (! o.maxItems || (o.maxItems && v.setItems.length < o.maxItems)) {\n        this.renderSuggestions(v.suggestedItems);\n        return this;\n      }\n    }\n\n    this.hideSuggestions();\n    return this;\n  }\n\n  showSuggestions() {\n    let v = this._vars;\n    let o = this._options;\n\n    if (v.suggestedItems.length) {\n      this.emit('showSuggestions', this);\n      if (!o.maxItems || (o.maxItems && v.setItems.length < o.maxItems)) {\n        this._html.suggest.style.display = 'block';\n        v.suggested = true;\n        this.renderSuggestions(v.suggestedItems);\n      }\n      this.emit('shownSuggestions', this);\n    } else {\n      this.hideSuggestions();\n    }\n    return this;\n  }\n\n  hideSuggestions() {\n    this.emit('hideSuggestions', this);\n    this._vars.suggested = false;\n    this._html.suggest.style.display = 'none';\n    this._html.suggestList.innerHTML = '';\n    this.emit('hiddenSuggestions', this);\n    return this;\n  }\n\n  setSuggestedItems(items) {\n    if (!Array.isArray(items)) {\n      throw new Error('Argument must be an array of objects.');\n    }\n\n    this._options.items = items;\n    this._refreshSuggestions();\n  }\n\n  getItems() {\n    return this._vars.setItems.map(item => {\n      let v = Object.assign({}, item);\n      delete v[this.key];\n      delete v.el;\n      return v;\n    });\n  }\n\n  setItems(items = []) {\n    this._vars.setItems = [];\n    this.addItems(items);\n    return this;\n  }\n\n  addItems(items = []) {\n    const key = this._options.itemValue;\n    if (! Array.isArray(items)) {\n      items = [items];\n    }\n\n    this._prepareData(items).forEach((item) => {\n      if (item.isNew || typeof item[key] !== 'undefined') {\n        this._addItem(item);\n      }\n    });\n\n    this._renderItems()\n      ._refreshInput()\n      .hideSuggestions();\n\n    return this;\n  }\n\n  sortItems() {\n    let items = [];\n\n    [...this._html.items.childNodes].forEach(el => {\n      let item = this._getItem(el.key);\n      if (item) {\n        items.push(item);\n      }\n    });\n\n    this.setItems(items);\n  }\n\n  removeItem(value) {\n    const o = this._options;\n    if (typeof value === 'object' &&\n      (value[o.itemValue] || value[o.newItemValue])\n    ) {\n      value = value[o.itemValue] || value[o.newItemValue];\n    }\n\n    let item = this._getItem(value, o.itemValue) ||\n               this._getItem(value, o.newItemValue);\n\n    if (! item) {\n      return this;\n    }\n\n    this._removeItem(item[this.key])._renderItems();\n\n    return this;\n  }\n\n  emptyItems() {\n    this._vars.setItems = [];\n    this._renderItems()\n      ._refreshInput()\n      .hideSuggestions();\n    this.emit('change', this);\n    return this;\n  }\n\n  getSuggestedItems() {\n    return this._vars.suggestedItems.map(item => {\n      return Object.assign({}, item);\n    });\n  }\n\n  focus() {\n    this._html.container.classList.add('focused');\n    if (! this._focused) this._html.input.focus();\n    return this;\n  }\n\n  blur() {\n    this._html.container.classList.remove('focused');\n    if (this._focused) this._html.input.blur();\n    return this;\n  }\n\n  remove() {\n    let html = this._html;\n\n    html.container.parentElement.insertBefore(this.el, html.container);\n    html.container.remove();\n    this.el.style.display = 'block';\n\n    if (Object.keys(_tokenfields).length === 1) {\n      document.removeEventListener('mousedown', this._vars.events.onMouseDown);\n      window.removeEventListener('resize', this._vars.events.onResize);\n    }\n\n    if (this._form && this._form.nodeName) {\n      this._form.removeEventListener('reset', this._vars.events.onReset);\n    }\n\n    delete _tokenfields[this.id];\n    delete this.el.tokenfield;\n  }\n}\n\nexport default Tokenfield;\n","/**\n * Simple AJAX handling module.\n * tokenfield 1.3.0 <https://github.com/KaneCohen/tokenfield>\n * Copyright 2018 Kane Cohen <https://github.com/KaneCohen>\n * Available under BSD-3-Clause license\n */\nexport default function ajax(params, options = {}, callback = null) {\n  let xhr = new XMLHttpRequest();\n  let url = options.url;\n  let paramsArr = [];\n  for (let key in params) {\n    paramsArr.push(`${key}=${encodeURIComponent(params[key])}`);\n  }\n\n  let paramsString = paramsArr.join('&');\n\n  if (options.type.toLowerCase() === 'get') {\n    url += '?' + paramsString;\n  }\n\n  xhr.open(options.type, url, true);\n\n  for (let header in options.headers) {\n    let value = options.headers[header];\n    if (typeof value === 'function') {\n      value = value(params, options);\n    }\n    xhr.setRequestHeader(header, value);\n  }\n\n  if (callback) {\n    xhr.onreadystatechange = callback;\n  }\n\n  xhr.send(params);\n\n  return xhr;\n}\n"],"sourceRoot":""}