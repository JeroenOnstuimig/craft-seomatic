{% from "seomatic/settings/_includes/macros.twig" import configWarning %}

{% extends "_layouts/cp" %}

{% import "_includes/forms" as forms %}

{% do view.registerAssetBundle("nystudio107\\seomatic\\assetbundles\\seomatic\\SeomaticAsset") %}
{% set baseAssetsUrl = view.getAssetManager().getPublishedUrl('@nystudio107/seomatic/assetbundles/seomatic/dist', true) %}

{% set tabs = {
    general: {
        url: "#tab-content-general",
        label: "General" |t("seomatic"),
    },
    twitter: {
        url: "#tab-content-twitter",
        label: "Twitter" |t("seomatic"),
    },
    facebook: {
        url: "#tab-content-facebook",
        label: "Facebook" |t("seomatic"),
    },
} %}

{% block header %}
    {{ block('pageTitle') }}
    {{ block('contextMenu') }}
    <div class="flex-grow"></div>
    <div class="flex-grow"></div>
    {{ block('actionButton') }}
{% endblock %}

{% block contextMenu %}
    {% include "seomatic/settings/_includes/sites-menu.twig" %}
{% endblock %}

{% block content %}
    
    <input type="hidden" name="action" value="seomatic/settings/save-global">
    <input type="hidden" name="siteId" value="{{ currentSiteId }}">
    {{ redirectInput("seomatic/global") }}

    <div id="tab-content-general">
        {% include "seomatic/settings/_includes/tab-general.twig" %}
    </div>
    
    <div id="tab-content-twitter" class="hidden">
        {% include "seomatic/_includes/twitterPreview.twig" %}
        {% namespace "globals" %}

            {{ forms.textField({
                label: "Twitter Title" |t("seomatic"),
                instructions: "Make sure your title tag is explicit and contains your most important keywords. Be sure that each page has a unique title tag." |t("seomatic"),
                id: "twitterTitle",
                name: "twitterTitle",
                value: globals.twitterTitle,
                class: "nicetext",
                maxlength: seomatic.config.maxTitleLength,
                showCharsLeft: true,
                warning: false,
            }) }}

            {{ forms.textAreaField({
                label: "Twitter Description" |t("seomatic"),
                instructions: "SEO descriptions allow you to influence how your web pages are described and displayed in search results. Ensure that all of your web pages have a unique meta description that is explicit and contains your most important keywords." |t("seomatic"),
                id: "twitterDescription",
                name: "twitterDescription",
                value: globals.twitterDescription,
                class: "nicetext",
                maxlength: seomatic.config.maxDescriptionLength,
                showCharsLeft: true,
                warning: false,
            }) }}
        {% endnamespace %}

        {% namespace "settings" %}
            {{ forms.elementSelectField({
                label: "Twitter Image"|t("seomatic"),
                instructions: "This is the image that will be used for display as the global website brand, as well as on Twitter Cards and Facebook OpenGraph that link to the website, if they are not specified. The image must be in JPG, PNG, or GIF format." |t("seomatic"),
                id: "twitterImageIds",
                name: "twitterImageIds",
                viewMode: "large",
                elements: twitterImageElements,
                elementType: elementType,
                criteria: {
                    kind: ["image"],
                },
                jsClass: 'Craft.AssetSelectInput',
                selectionLabel: "Select Twitter Image" |t("seomatic"),
                sources: [],
                limit: 1,
                warning: false,
            }) }}
        {% endnamespace %}

        {% namespace "globals" %}
            {{ forms.textField({
                label: "Twitter Image Description" |t("seomatic"),
                instructions: "Description of the Twitter Image" |t("seomatic"),
                id: "twitterImageDescription",
                name: "twitterImageDescription",
                value: globals.twitterImageDescription,
                class: "nicetext",
                warning: false,
            }) }}
        {% endnamespace %}
    </div>

    <div id="tab-content-facebook" class="hidden">
        {% include "seomatic/_includes/facebookPreview.twig" %}
        {% namespace "globals" %}

            {{ forms.textField({
                label: "Facebook OpenGraph Title" |t("seomatic"),
                instructions: "Make sure your title tag is explicit and contains your most important keywords. Be sure that each page has a unique title tag." |t("seomatic"),
                id: "ogTitle",
                name: "ogTitle",
                value: globals.ogTitle,
                class: "nicetext",
                maxlength: seomatic.config.maxTitleLength,
                showCharsLeft: true,
                warning: false,
            }) }}

            {{ forms.textAreaField({
                label: "Facebook OpenGraph Description" |t("seomatic"),
                instructions: "SEO descriptions allow you to influence how your web pages are described and displayed in search results. Ensure that all of your web pages have a unique meta description that is explicit and contains your most important keywords." |t("seomatic"),
                id: "ogDescription",
                name: "ogDescription",
                value: globals.ogDescription,
                class: "nicetext",
                maxlength: seomatic.config.maxDescriptionLength,
                showCharsLeft: true,
                warning: false,
            }) }}
        {% endnamespace %}

        {% namespace "settings" %}
            {{ forms.elementSelectField({
                label: "Facebook OpenGraph Image"|t("seomatic"),
                instructions: "This is the image that will be used for display as the global website brand, as well as on Twitter Cards and Facebook OpenGraph that link to the website, if they are not specified. The image must be in JPG, PNG, or GIF format." |t("seomatic"),
                id: "ogImageIds",
                name: "ogImageIds",
                viewMode: "large",
                elements: ogImageElements,
                elementType: elementType,
                criteria: {
                    kind: ["image"],
                },
                jsClass: 'Craft.AssetSelectInput',
                selectionLabel: "Select Facebook OpenGraph Image" |t("seomatic"),
                sources: [],
                limit: 1,
                warning: false,
            }) }}
        {% endnamespace %}

        {% namespace "globals" %}
            {{ forms.textField({
                label: "Facebook OpenGraph Image Description" |t("seomatic"),
                instructions: "Description of the Facebook OpenGraph Image" |t("seomatic"),
                id: "ogImageDescription",
                name: "ogImageDescription",
                value: globals.ogImageDescription,
                class: "nicetext",
                warning: false,
            }) }}
        {% endnamespace %}
    </div>

{% endblock %}
