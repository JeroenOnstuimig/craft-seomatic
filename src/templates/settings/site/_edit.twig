{% requirePermission "seomatic:site-settings" %}

{% extends "_layouts/cp" %}

{% from "seomatic/settings/_includes/macros.twig" import configWarning %}
{% import "_includes/forms" as forms %}

{% set tabs = {} %}
{% if currentUser.can("seomatic:site-settings:identity") %}
    {% set tabs = tabs |merge({
        identity: {
            url: "#tab-content-identity",
            label: "Identity" |t("seomatic"),
        },
    }) %}
{% endif %}
{% if currentUser.can("seomatic:site-settings:creator") %}
    {% set tabs = tabs |merge({
        creator: {
            url: "#tab-content-creator",
            label: "Creator" |t("seomatic"),
        },
    }) %}
{% endif %}
{% if currentUser.can("seomatic:site-settings:social-media") %}
    {% set tabs = tabs |merge({
        social: {
            url: "#tab-content-social",
            label: "Social Media" |t("seomatic"),
        }
    }) %}
{% endif %}

{% block header %}
    {{ block('pageTitle') }}
    {{ block('contextMenu') }}
    <div class="flex-grow"></div>
    <div class="flex-grow"></div>
    {{ block('actionButton') }}
{% endblock %}

{% block contextMenu %}
    {% include "seomatic/settings/_includes/sites-menu.twig" %}
{% endblock %}

{% block content %}
    
    <input type="hidden" name="action" value="seomatic/settings/save-site">
    <input type="hidden" name="siteId" value="{{ currentSiteId }}">
    {{ redirectInput("seomatic/site/#{currentSiteHandle}") }}
    
    {% if currentUser.can("seomatic:site-settings:identity") %}
        <div id="tab-content-identity">
            {% include "seomatic/settings/site/_includes/tab-identity.twig" %}
        </div>
    {% endif %}

    {% if currentUser.can("seomatic:site-settings:creator") %}
        <div id="tab-content-creator" class="hidden">
            {% include "seomatic/settings/site/_includes/tab-creator.twig" %}
        </div>
    {% endif %}

    {% if currentUser.can("seomatic:site-settings:social-media") %}
        <div id="tab-content-social" class="hidden">
            {% include "seomatic/settings/site/_includes/tab-social.twig" %}
        </div>
    {% endif %}
    
    {% include "seomatic/_includes/footer-message.twig" with {
        message: "Any text fields can include single-bracket tags that output Seomatic properties, such as `{seomatic.meta.seoTitle}`."
    } %}
{% endblock %}
